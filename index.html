<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>stock tracker · Holographic</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Pretendard -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css"/>

    <!-- React 18 -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      :root{
        --text:#0e172a;
        --muted:#6b7280;
        --stroke:rgba(255,255,255,.18);
        --glass:rgba(255,255,255,.22);
        --shadow:0 8px 32px rgba(2,6,23,.18);
        --safe:env(safe-area-inset-bottom,0px);
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      body{
        font-family:"Pretendard Variable",Pretendard,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Apple SD Gothic Neo","Malgun Gothic",sans-serif;
        color:var(--text);
        font-size:.95rem;
        overflow-x:hidden;
      }

      /* ===== Holographic Background ===== */
      .holo-bg{
        position:fixed; inset:0; z-index:-2;
        background:
          radial-gradient(1200px 800px at 10% 10%, #7c3aed44 0%, transparent 60%),
          radial-gradient(900px 700px at 90% 10%, #22d3ee44 0%, transparent 60%),
          radial-gradient(1000px 800px at 50% 100%, #f472b644 0%, transparent 55%),
          linear-gradient(135deg,#e9efff 0%,#f7fbff 30%,#f5f0ff 60%,#f0fbff 100%);
        filter:saturate(115%) contrast(105%);
      }
      .holo-noise:before{
        content:""; position:fixed; inset:-10%; z-index:-1; pointer-events:none;
        background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="140" height="140" viewBox="0 0 140 140"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.035"/></svg>');
        mix-blend-mode:overlay;
      }

      /* ===== Glassmorphism Card ===== */
      .glass-card{
        background:var(--glass);
        border:1px solid var(--stroke);
        border-radius:16px;
        box-shadow:var(--shadow);
        backdrop-filter:blur(18px) saturate(120%);
        -webkit-backdrop-filter:blur(18px) saturate(120%);
      }

      .holo-btn{
        position:relative; border-radius:14px; padding:10px 14px;
        color:#0b1220; border:1px solid transparent; cursor:pointer;
        background:
          linear-gradient(180deg,rgba(255,255,255,.95),rgba(255,255,255,.75)) padding-box,
          conic-gradient(from 180deg at 50% 50%, #7c3aed,#06b6d4,#22d3ee,#f472b6,#7c3aed) border-box;
        box-shadow:0 10px 24px rgba(0,0,0,.08), inset 0 1px 0 rgba(255,255,255,.7);
        transition:transform .15s ease, box-shadow .2s ease;
      }
      .holo-btn:hover{ transform:translateY(-1px) }
      .holo-btn:active{ transform:translateY(1px) }

      .glass-input,.glass-select,.glass-textarea{
        border:1px solid rgba(0,0,0,.08);
        background:rgba(255,255,255,.6);
        border-radius:12px;
        transition:.2s ease; font-size:16px;
      }
      .glass-input:focus,.glass-select:focus,.glass-textarea:focus{
        outline:none; border-color:#93c5fd; box-shadow:0 0 0 3px rgba(147,197,253,.35);
        background:rgba(255,255,255,.9);
      }

      .muted{color:var(--muted)}

      /* ===== Bottom Sheet ===== */
      .sheet{position:fixed;left:0;right:0;bottom:0;z-index:60;transform:translateY(100%);transition:transform .25s ease}
      .sheet.open{transform:translateY(0)}
      .sheet-body{background:rgba(255,255,255,.9);backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px); border-top-left-radius:18px;border-top-right-radius:18px;box-shadow:0 -10px 30px rgba(0,0,0,.12); padding-bottom:calc(12px + var(--safe))}
      .sheet-handle{width:42px;height:4px;border-radius:9999px;background:#e5e7eb;margin:8px auto}

      /* ===== Carousel (snap) ===== */
      .h-snap{scroll-snap-type:x mandatory}
      .h-snap > *{scroll-snap-align:center}
      .pane{min-width:88vw}
      @media (min-width:1024px){ .pane{min-width:520px} }

      /* Stats text overflow fix */
      .stat-value{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

      footer{display:none} /* 하단 문구 비표시 */
    </style>
  </head>
  <body class="min-h-screen holo-noise">
    <div class="holo-bg"></div>

    <div id="root" class="min-h-screen relative z-10"></div>

    <script type="text/babel">
      const { useState, useMemo, useEffect } = React;

      const APP_KEY = "swing-home-v2-mobile";
      const STOCKS = [
        { key: "kakao", name: "카카오" },
        { key: "samsung", name: "삼성전자" },
        { key: "sm", name: "에스엠" },
      ];

      const defaultJournalEntry = () => ({
        id: crypto && crypto.randomUUID ? crypto.randomUUID() : String(Date.now()+Math.random()),
        date: new Date().toISOString().slice(0,10),
        side: "매수",
        qty: "", price: "",
        plan: "", reason: "",
        target: "1% 절반 익절, 3~5% 연장",
        stop: "최대 -2%",
        outcome: "진행중",
        resultPct: "", resultPnl: "",
        hold: false,
        good: "",        // 잘한 점
        feedback: "",    // 피드백
        tags: "스윙",
      });

      const defaultState = {
        settings: { initialSeed: 16000000 },
        monthlyPnL: {},
        journals: { kakao: [], samsung: [], sm: [] },
      };

      function useLocalState(key, initial){
        const [state, setState] = React.useState(() => {
          try{
            const hash = new URLSearchParams(location.hash.replace(/^#/, "")).get("data");
            if(hash) return JSON.parse(atob(hash));
          }catch(e){}
          try{
            const raw = localStorage.getItem(key);
            return raw ? JSON.parse(raw) : initial;
          }catch(e){ return initial; }
        });
        useEffect(()=>{ try{ localStorage.setItem(key, JSON.stringify(state)); }catch(e){} },[key,state]);
        return [state, setState];
      }

      const currency = (n)=> Number(n||0).toLocaleString();
      const pct = (n)=> isFinite(n) ? (Math.round(n*10)/10).toFixed(1) : "0.0";

      const Pane = ({title, right, children}) => (
        <section className="pane glass-card p-4 lg:p-6">
          <div className="flex items-center justify-between mb-3">
            <h3 className="text-base font-medium tracking-wide">{title}</h3>
            <div className="flex items-center gap-2">{right}</div>
          </div>
          {children}
        </section>
      );

      const Stat = ({label, value}) => (
        <div className="glass-card p-3">
          <div className="text-xs muted">{label}</div>
          <div className="stat-value text-[1.05rem] font-medium">{value}</div>
        </div>
      );

      /* ===== 월별 실현 손익 (편집 토글) ===== */
      function MonthlyPnLTable({ monthly, onChange }){
        const [year, setYear] = React.useState(new Date().getFullYear());
        const [edit, setEdit] = React.useState(false);
        const [justSaved, setJustSaved] = React.useState(false);
        const months = Array.from({length:12}, (_,i)=>i+1);
        const ym = (y,m)=> `${y}-${String(m).padStart(2,'0')}`;

        useEffect(()=>{
          if(!justSaved) return;
          const t = setTimeout(()=>setJustSaved(false), 900);
          return ()=>clearTimeout(t);
        },[justSaved]);

        const change = (key, raw)=>{
          const cleaned = raw.replace(/[^\d\-]/g,'');
          onChange(key, cleaned);
          setJustSaved(true);
        };

        return (
          <div>
            <div className="flex items-center gap-2 mb-2">
              <span className="text-xs muted">연도</span>
              <select className="glass-select px-2 py-1"
                value={year} onChange={e=>setYear(Number(e.target.value))}>
                {Array.from({length:6},(_,i)=>new Date().getFullYear()-3+i).map(y=>
                  <option key={y} value={y}>{y}</option>
                )}
              </select>
              <div className="ml-auto flex items-center gap-2">
                {justSaved && <span className="text-xs text-emerald-600">저장됨</span>}
                <button className="glass-btn px-3 py-1" onClick={()=>setEdit(v=>!v)}>{edit?'완료':'편집'}</button>
              </div>
            </div>

            <div className="grid grid-cols-2 md:grid-cols-3 gap-3">
              {months.map(m=>{
                const key = ym(year,m);
                const v = monthly[key] ?? '';
                return (
                  <div key={key} className="glass-card p-2">
                    <div className="text-xs muted mb-1">{year}년 {m}월</div>
                    <input
                      className={"glass-input w-full px-3 py-2 text-right "+(!edit ? "bg-white/60 cursor-default":"")}
                      placeholder="예: 140000"
                      value={v}
                      readOnly={!edit}
                      onChange={e=>change(key, e.target.value)}
                    />
                  </div>
                );
              })}
            </div>
          </div>
        );
      }

      function EditorSheet({ editing, setEditing, onSave }){
        if(!editing) return null;
        const { entry, stock } = editing;
        const update = (k,v)=> setEditing(p=> ({...p, entry:{...p.entry, [k]:v}}));
        return (
          <div className="sheet open">
            <div className="sheet-body">
              <div className="sheet-handle"></div>
              <div className="px-4 pt-1 pb-4">
                <div className="flex items-center justify-between">
                  <div className="text-sm muted">일지 입력 · {stock}</div>
                  <button className="glass-btn" onClick={()=>setEditing(null)}>닫기</button>
                </div>

                <div className="grid grid-cols-2 gap-3 mt-3">
                  <div>
                    <div className="text-xs muted mb-1">날짜</div>
                    <input type="date" className="glass-input w-full px-3 py-2"
                      value={entry.date} onChange={e=>update('date', e.target.value)}/>
                  </div>
                  <div>
                    <div className="text-xs muted mb-1">사이드</div>
                    <select className="glass-input w-full px-3 py-2"
                      value={entry.side} onChange={e=>update('side', e.target.value)}>
                      <option>매수</option><option>매도</option><option>관망</option><option>청산</option>
                    </select>
                  </div>

                  <div>
                    <div className="text-xs muted mb-1">수량</div>
                    <input inputMode="numeric" pattern="[0-9]*" className="glass-input w-full px-3 py-2"
                      value={entry.qty} onChange={e=>update('qty', e.target.value)}/>
                  </div>
                  <div>
                    <div className="text-xs muted mb-1">가격</div>
                    <input inputMode="decimal" className="glass-input w-full px-3 py-2"
                      value={entry.price} onChange={e=>update('price', e.target.value)}/>
                  </div>

                  <div className="col-span-2">
                    <div className="text-xs muted mb-1">부분익절/목표</div>
                    <input className="glass-input w-full px-3 py-2"
                      value={entry.target} onChange={e=>update('target', e.target.value)}/>
                  </div>
                  <div className="col-span-2">
                    <div className="text-xs muted mb-1">리스크/손절</div>
                    <input className="glass-input w-full px-3 py-2"
                      value={entry.stop} onChange={e=>update('stop', e.target.value)}/>
                  </div>

                  <div className="col-span-2">
                    <div className="text-xs muted mb-1">진입 계획(시나리오)</div>
                    <textarea rows="2" className="glass-input w-full px-3 py-2"
                      value={entry.plan} onChange={e=>update('plan', e.target.value)} />
                  </div>
                  <div className="col-span-2">
                    <div className="text-xs muted mb-1">실행/종료 이유</div>
                    <textarea rows="2" className="glass-input w-full px-3 py-2"
                      value={entry.reason} onChange={e=>update('reason', e.target.value)} />
                  </div>

                  <div>
                    <div className="text-xs muted mb-1">실현 수익률(%)</div>
                    <input inputMode="decimal" className="glass-input w-full px-3 py-2"
                      value={entry.resultPct} onChange={e=>update('resultPct', e.target.value)}/>
                  </div>
                  <div>
                    <div className="text-xs muted mb-1">실현 손익(₩)</div>
                    <input inputMode="decimal" className="glass-input w-full px-3 py-2"
                      value={entry.resultPnl} onChange={e=>update('resultPnl', e.target.value)}/>
                  </div>

                  <div>
                    <div className="text-xs muted mb-1">보유</div>
                    <select className="glass-input w-full px-3 py-2"
                      value={entry.hold?'Y':'N'} onChange={e=>update('hold', e.target.value==='Y')}>
                      <option value="N">아니오</option>
                      <option value="Y">예</option>
                    </select>
                  </div>

                  <div className="col-span-2">
                    <div className="text-xs muted mb-1">잘한 점</div>
                    <textarea rows="2" className="glass-input w-full px-3 py-2"
                      value={entry.good} onChange={e=>update('good', e.target.value)} />
                  </div>
                  <div className="col-span-2">
                    <div className="text-xs muted mb-1">피드백</div>
                    <textarea rows="3" className="glass-input w-full px-3 py-2"
                      value={entry.feedback} onChange={e=>update('feedback', e.target.value)} />
                  </div>
                </div>

                <div className="sticky bottom-0 bg-white/70 backdrop-blur pt-3 mt-3 rounded-b-xl">
                  <div className="flex gap-2">
                    <button className="glass-btn flex-1" onClick={()=>setEditing(null)}>취소</button>
                    <button className="holo-btn flex-1" onClick={onSave}>저장</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      function App(){
        const [state, setState] = useLocalState(APP_KEY, defaultState);
        const [tab, setTab] = useState("dashboard");
        const [stockTab, setStockTab] = useState(STOCKS[0].key);
        const [q, setQ] = useState("");
        const [sortKey, setSortKey] = useState("date");
        const [sortDir, setSortDir] = useState("desc");
        const [editing, setEditing] = useState(null);

        const realized = useMemo(()=>{
          return ["kakao","samsung","sm"].flatMap(k=>state.journals[k])
            .filter(e=>!e.hold && Number(e.resultPnl||0)!==0);
        },[state]);

        const totals = useMemo(()=>{
          const monthlyTotal = Object.values(state.monthlyPnL).reduce((s,v)=>s+Number(v||0),0);
          const pnl = realized.reduce((s,e)=>s+Number(e.resultPnl||0),0);
          const initialSeed = Number(state.settings?.initialSeed||0);
          const currentSeed = initialSeed + pnl;
          const roi = initialSeed>0 ? (pnl/initialSeed)*100 : 0;
          return { monthlyTotal, pnl, initialSeed, currentSeed, roi };
        },[state, realized]);

        const filtered = useMemo(()=>{
          let arr = [...state.journals[stockTab]];
          if(q){
            const t=q.toLowerCase();
            arr = arr.filter(e=>[e.date,e.side,e.plan,e.reason,e.good,e.feedback].join(" ").toLowerCase().includes(t));
          }
          const dir=(sortDir==='asc'?1:-1);
          arr.sort((a,b)=>(a[sortKey]>b[sortKey]?dir:-dir));
          return arr;
        },[state,stockTab,q,sortKey,sortDir]);

        function addEntry(stock){ setEditing({stock, entry: defaultJournalEntry()}); }
        function editEntry(stock,id){ const e=state.journals[stock].find(x=>x.id===id); if(e) setEditing({stock, entry:{...e}}); }
        function removeEntry(stock,id){
          if(!confirm("삭제할까요?")) return;
          setState(prev=>({...prev, journals:{...prev.journals, [stock]: prev.journals[stock].filter(e=>e.id!==id)}}));
        }
        function saveEntry(){
          const {stock, entry}=editing;
          setState(prev=>{
            const exists = prev.journals[stock].some(e=>e.id===entry.id);
            const next = exists
              ? prev.journals[stock].map(e=>e.id===entry.id?entry:e)
              : [entry, ...prev.journals[stock]];
            return {...prev, journals:{...prev.journals, [stock]: next}};
          });
          setEditing(null);
        }

        const setMonthly = (ym, value)=> setState(prev=>({...prev, monthlyPnL:{...prev.monthlyPnL, [ym]: value}}));
        const setInitialSeed = (v)=> setState(prev=>({...prev, settings:{...prev.settings, initialSeed:v}}));

        return (
          <div className="max-w-7xl mx-auto p-4 pb-24">
            {/* HEADER */}
            <div className="flex items-center justify-between mb-6">
              <div>
                <h1 className="text-2xl lg:text-3xl font-semibold tracking-tight">stock tracker</h1>
                {/* 부제는 감춤 또는 짧게 */}
                <p className="muted mt-1 text-sm">swing diary & monthly pnl • local only</p>
              </div>
              <div className="flex gap-2">
                <button className={`glass-btn ${tab==='dashboard' && 'ring-2 ring-sky-300'}`} onClick={()=>setTab('dashboard')}>대시보드</button>
                <button className={`glass-btn ${tab==='journal' && 'ring-2 ring-sky-300'}`} onClick={()=>setTab('journal')}>일지</button>
                <button className={`glass-btn ${tab==='settings' && 'ring-2 ring-sky-300'}`} onClick={()=>setTab('settings')}>설정</button>
              </div>
            </div>

            {/* DASHBOARD as Holo Carousel */}
            {tab==='dashboard' && (
              <div className="flex gap-4 overflow-x-auto h-snap pb-2">
                {/* 월별 실현 손익 */}
                <Pane title="월별 실현 손익">
                  <MonthlyPnLTable monthly={state.monthlyPnL} onChange={setMonthly}/>
                  <div className="grid grid-cols-2 md:grid-cols-4 gap-3 mt-4">
                    <Stat label="월 합계"     value={`${currency(totals.monthlyTotal)} 원`} />
                    <Stat label="현재 시드"   value={`${currency(totals.currentSeed)} 원`} />
                    <Stat label="수익률"     value={`${pct(totals.roi)} %`} />
                    <Stat label="총 일지 수" value={`${['kakao','samsung','sm'].reduce((s,k)=>s+state.journals[k].length,0)} 건`} />
                  </div>
                </Pane>

                {/* 새 일지 */}
                <Pane title="새 일지">
                  <div className="flex flex-wrap gap-2">
                    {STOCKS.map(s=>(
                      <button key={s.key} className="holo-btn" onClick={()=>addEntry(s.key)}>{s.name}</button>
                    ))}
                  </div>
                </Pane>

                {/* 가이드 */}
                <Pane title="가이드">
                  <ul className="list-disc pl-5 text-sm muted space-y-1">
                    <li>설정에서 <b>초기 시드</b>를 입력/수정하세요.</li>
                    <li>대시보드 카드들은 가로 스와이프로 넘겨볼 수 있어요.</li>
                    <li>월별 실현손익은 <b>편집</b>을 눌러야 수정됩니다.</li>
                    <li>데이터는 기기에만 저장돼요(브라우저 로컬).</li>
                  </ul>
                </Pane>
              </div>
            )}

            {/* JOURNAL */}
            {tab==='journal' && (
              <div className="glass-card p-4">
                <div className="flex flex-wrap items-center justify-between gap-2 mb-3">
                  <div className="flex gap-2">
                    {STOCKS.map(s=>(
                      <button key={s.key} className={`glass-btn ${stockTab===s.key && 'ring-2 ring-sky-300'}`} onClick={()=>setStockTab(s.key)}>{s.name}</button>
                    ))}
                  </div>
                  <div className="flex items-center gap-2">
                    <input className="glass-input w-full max-w-[200px] px-3 py-2" placeholder="검색" value={q} onChange={e=>setQ(e.target.value)} />
                    <select className="glass-select px-3 py-2" value={sortKey} onChange={e=>setSortKey(e.target.value)}>
                      <option value="date">날짜</option>
                      <option value="resultPnl">손익</option>
                    </select>
                    <select className="glass-select px-3 py-2" value={sortDir} onChange={e=>setSortDir(e.target.value)}>
                      <option value="desc">내림</option><option value="asc">오름</option>
                    </select>
                    <button className="holo-btn hidden md:inline-flex" onClick={()=>addEntry(stockTab)}>새 일지</button>
                  </div>
                </div>

                {/* 데스크톱 테이블 (피드백만 노출) */}
                <div className="overflow-auto rounded-xl border border-white/30 hidden md:block">
                  <table className="min-w-full text-sm">
                    <thead className="bg-white/50">
                      <tr>{["날짜","사이드","수량","가격","실현(%)","실현(₩)","보유","피드백","작업"].map(h=>
                        <th key={h} className="px-3 py-2 text-left whitespace-nowrap">{h}</th>)}
                      </tr>
                    </thead>
                    <tbody>
                      {filtered.map(e=>(
                        <tr key={e.id} className="hover:bg-white/40">
                          <td className="px-3 py-2 whitespace-nowrap">{e.date}</td>
                          <td className="px-3 py-2 whitespace-nowrap">{e.side}</td>
                          <td className="px-3 py-2 text-right">{e.qty}</td>
                          <td className="px-3 py-2 text-right">{e.price}</td>
                          <td className="px-3 py-2 text-right">{e.resultPct}</td>
                          <td className="px-3 py-2 text-right">{e.resultPnl}</td>
                          <td className="px-3 py-2">{e.hold?'보유':'-'}</td>
                          <td className="px-3 py-2">{e.feedback||""}</td>
                          <td className="px-3 py-2 whitespace-nowrap">
                            <div className="flex gap-2">
                              <button className="glass-btn" onClick={()=>editEntry(stockTab, e.id)}>수정</button>
                              <button className="glass-btn text-rose-600 border-rose-200" onClick={()=>removeEntry(stockTab, e.id)}>삭제</button>
                            </div>
                          </td>
                        </tr>
                      ))}
                      {filtered.length===0 && (
                        <tr><td colSpan="9" className="px-3 py-10 text-center muted">기록이 없습니다. 우상단 “새 일지”.</td></tr>
                      )}
                    </tbody>
                  </table>
                </div>

                {/* 모바일 카드 */}
                <div className="space-y-2 md:hidden">
                  {filtered.map(e=>(
                    <div key={e.id} className="glass-card border border-white/30 rounded-xl p-3">
                      <div className="flex items-center justify-between">
                        <div className="text-sm">{e.date} · <span className="muted">{e.side}</span></div>
                        {/* 실현(₩) 숨김 */}
                      </div>
                      <div className="grid grid-cols-2 gap-x-4 gap-y-1 mt-2 text-[13px]">
                        <div><span className="muted">수량</span> {e.qty||'-'}</div>
                        <div><span className="muted">가격</span> {e.price||'-'}</div>
                        <div><span className="muted">실현(%)</span> {e.resultPct||'-'}</div>
                      </div>
                      {/* 피드백만 표시 */}
                      {e.feedback && <div className="mt-2 text-[13px] text-slate-800">{e.feedback}</div>}
                      <div className="mt-3 flex gap-2">
                        <button className="glass-btn" onClick={()=>editEntry(stockTab, e.id)}>수정</button>
                        <button className="glass-btn text-rose-600 border-rose-200" onClick={()=>removeEntry(stockTab, e.id)}>삭제</button>
                      </div>
                    </div>
                  ))}
                  {filtered.length===0 && <div className="text-center muted py-6 text-sm">아직 기록이 없어요. 우하단 <b>+</b> 버튼으로 추가!</div>}
                </div>
              </div>
            )}

            {/* SETTINGS */}
            {tab==='settings' && (
              <div className="grid lg:grid-cols-2 gap-4">
                <div className="glass-card p-4">
                  <h3 className="text-base font-medium mb-3">초기 시드</h3>
                  <div className="flex items-center gap-2">
                    <input inputMode="numeric" pattern="[0-9]*"
                      className="glass-input w-56 px-3 py-2 text-right"
                      value={state.settings.initialSeed}
                      onChange={e=>{
                        const v = Number(String(e.target.value).replace(/[^0-9]/g,'')||0);
                        setInitialSeed(v);
                      }}/>
                    <span className="text-sm">원</span>
                  </div>
                  <p className="text-xs muted mt-2">대시보드 통계 계산에 사용됩니다.</p>
                </div>

                <div className="glass-card p-4">
                  <h3 className="text-base font-medium mb-3">백업/복원</h3>
                  <div className="flex flex-wrap gap-2">
                    <button className="glass-btn" onClick={()=>{
                      const blob = new Blob([JSON.stringify(state,null,2)],{type:'application/json'});
                      const url = URL.createObjectURL(blob);
                      const a = document.createElement('a'); a.href=url; a.download=`swing-tracker-backup-${Date.now()}.json`; a.click();
                      URL.revokeObjectURL(url);
                    }}>JSON 백업</button>
                    <label className="glass-btn cursor-pointer">복원
                      <input type="file" accept="application/json" className="hidden"
                        onChange={e=>{
                          const f=e.target.files?.[0]; if(!f) return;
                          const r=new FileReader();
                          r.onload=()=>{ try{ const data=JSON.parse(r.result); setState(data);}catch{ alert('형식 오류'); } };
                          r.readAsText(f);
                        }}/>
                    </label>
                  </div>
                  <p className="text-xs muted mt-2">* 데이터는 브라우저에만 저장됩니다.</p>
                </div>

                <div className="glass-card p-4 lg:col-span-2">
                  <h3 className="text-base font-medium mb-2">프라이빗 링크</h3>
                  <p className="text-xs muted mb-2">현재 상태를 URL 해시(#data=...)로 저장하여 복구할 수 있어요.</p>
                  <div className="flex gap-2">
                    <button className="holo-btn" onClick={()=>{
                      try{
                        const link = `${location.href.split('#')[0]}#data=${btoa(JSON.stringify(state))}`;
                        navigator.clipboard.writeText(link); alert('링크를 복사했어요.');
                      }catch(e){ alert('링크 생성 실패'); }
                    }}>링크 복사</button>
                    <button className="glass-btn" onClick={()=>{
                      const link = `${location.href.split('#')[0]}#data=${btoa(JSON.stringify(state))}`;
                      prompt('아래 링크를 복사하세요', link);
                    }}>링크 보기</button>
                  </div>
                </div>
              </div>
            )}

            {/* FAB */}
            {tab!=='settings' && (
              <div className="fixed right-4 bottom-[calc(16px+var(--safe))] md:hidden">
                <button className="holo-btn text-base px-4 py-3" aria-label="새 일지 추가" onClick={()=>addEntry(stockTab)}>＋</button>
              </div>
            )}

            {/* EDITOR SHEET */}
            <EditorSheet editing={editing} setEditing={setEditing} onSave={saveEntry}/>
          </div>
        );
      }

      const root = document.getElementById('root');
      ReactDOM.createRoot(root).render(<App/>);
    </script>
  </body>
</html>